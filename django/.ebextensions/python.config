container_commands:
    01_migrate:
        command: 'python manage.py migrate --noinput'
        leader_only: true
    # You can define a build script in packages.json (using gulp, grunt...) to build your client side files
    02_npm_build:
        command: 'npm install && npm run build'
    03_run_server.js:
        command: 'node server.js'
    04_collectstatic:
        command: 'python manage.py collectstatic --noinput'
commands:
  03_node_update:
      cwd: /tmp
      test: '[ ! -f /usr/bin/n ] && echo "node not updated"'
      command: 'npm install -g n && n stable'

option_settings:
  "aws:elasticbeanstalk:application:environment":
    DJANGO_SETTINGS_MODULE: "djreact.settings"
    PYTHONPATH: "/opt/python/current/app/djreactl:$PYTHONPATH"
    "ALLOWED_HOSTS": ".elasticbeanstalk.com"
  "aws:elasticbeanstalk:container:python":
    WSGIPath: "djreact/wsgi.py"
  "aws:elasticbeanstalk:container:python:staticfiles":
    "/static/": "www/static/"

packages:
  yum:
    git: []
    mysql: []
    mysql-server: []
